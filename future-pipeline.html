<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R8 Future Pricing Pipeline - Modern Data Architecture</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 4px solid #3498db;
            padding-bottom: 20px;
            font-size: 2.5rem;
            font-weight: 700;
        }
        h2 {
            color: #34495e;
            margin-top: 50px;
            margin-bottom: 25px;
            border-left: 6px solid #3498db;
            padding-left: 20px;
            font-size: 1.8rem;
            font-weight: 600;
        }
        h3 {
            color: #2980b9;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        .diagram-container {
            margin: 40px 0;
            padding: 30px;
            border: 2px solid #ddd;
            border-radius: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }
        .mermaid {
            text-align: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        .description {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-style: italic;
            color: #1565c0;
            border-left: 5px solid #2196f3;
        }
        .metrics-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .metrics-table th, .metrics-table td {
            border: 1px solid #e0e0e0;
            padding: 15px;
            text-align: left;
        }
        .metrics-table th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }
        .metrics-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .metrics-table tr:hover {
            background-color: #e3f2fd;
        }
        .highlight {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffc107;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            box-shadow: 0 8px 25px rgba(255, 193, 7, 0.2);
        }
        .highlight h3 {
            color: #e67e22;
            margin-top: 0;
        }
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .tech-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        .tech-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        .tech-card h4 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        .tech-card ul {
            list-style: none;
            padding: 0;
        }
        .tech-card li {
            padding: 5px 0;
            color: #555;
            position: relative;
            padding-left: 20px;
        }
        .tech-card li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
        }
        .pipeline-stage {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        .pipeline-stage h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .status-success {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .status-processing {
            background: rgba(52, 152, 219, 0.1);
            color: #3498db;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }
        footer {
            text-align: center;
            margin-top: 60px;
            padding: 30px;
            color: #7f8c8d;
            font-style: italic;
            border-top: 2px solid #ecf0f1;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí∞ R8 Future Pricing Pipeline<br><small style="font-size: 0.6em; color: #7f8c8d;">Batch Data Processing Architecture with Databricks</small></h1>
        
        <div class="highlight">
            <h3>üéØ Platform Overview</h3>
            <p><strong>Enterprise Batch Processing Pipeline:</strong> Production-grade batch data pipeline processing daily pricing updates for vacation rental optimization. Performs scheduled batch extraction from PriceLabs API with neighborhood analytics, occupancy forecasting, and dynamic pricing strategies through Databricks' medallion architecture (Bronze ‚Üí Silver ‚Üí Gold layers).</p>
        </div>

        <h2>1. Complete System Architecture</h2>
        <div class="description">
            End-to-end data pipeline showing API extraction, medallion architecture transformation, and business intelligence outputs with BigQuery integration.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
                flowchart TB
                    subgraph "External Data Sources"
                        GSHEETS[üìä Google Sheets<br/>Client Management<br/>API Keys Storage<br/>Configuration Data<br/>Batch Status Tracking]
                        PRICELAB[üåê PriceLabs API<br/>Listing Prices<br/>Neighborhood Data<br/>Rate Plans<br/>Reservations<br/>Overrides<br/>Daily Batch Extraction]
                    end
                    
                    subgraph "Data Extraction Layer"
                        MODULE[üì¶ ClientPriceLab Module<br/>Batch API Handler<br/>Rate Limiting<br/>Error Handling<br/>JSON Storage]
                        STORAGE[üíæ JSON Storage<br/>Date Partitioned<br/>/FileStore/pricelab_data<br/>Batch API Responses<br/>Change Detection]
                    end
                    
                    subgraph "Databricks Medallion Architecture"
                        BRONZE[ü•â Bronze Layer<br/>Raw Data Ingestion<br/>Schema Preservation<br/>Data Type Casting<br/>Timestamp Addition]
                        SILVER[ü•à Silver Layer<br/>Data Cleansing<br/>Deduplication<br/>Business Logic<br/>Standardization]
                        GOLD[üèÜ Gold Layer<br/>future_pricing_data<br/>Business Ready<br/>Aggregated Metrics<br/>365-day Forecasts]
                    end
                    
                    subgraph "Data Validation & Quality"
                        VALIDATE[‚úÖ Validation Layer<br/>Duplicate Detection<br/>Data Completeness<br/>Column Validation<br/>Quality Scoring]
                        UPDATE[üîÑ Status Updates<br/>Google Sheets Sync<br/>Collection Status<br/>Quality Metrics<br/>Error Reporting]
                    end
                    
                    subgraph "Analytics & Distribution"
                        BIGQUERY[‚òÅÔ∏è BigQuery Export<br/>r8_data<br/>future_pricing_data<br/>Cloud Analytics<br/>BI Integration]
                        ANALYTICS[üìä Business Analytics<br/>Pricing Optimization<br/>Occupancy Forecasting<br/>Revenue Management<br/>Market Intelligence]
                    end
                    
                    GSHEETS --> MODULE
                    PRICELAB --> MODULE
                    MODULE --> STORAGE
                    STORAGE --> BRONZE
                    BRONZE --> SILVER
                    SILVER --> GOLD
                    GOLD --> VALIDATE
                    VALIDATE --> UPDATE
                    UPDATE --> GSHEETS
                    GOLD --> BIGQUERY
                    BIGQUERY --> ANALYTICS
                    
                    style BRONZE fill:#cd7f32,color:#fff
                    style SILVER fill:#c0c0c0,color:#000
                    style GOLD fill:#ffd700,color:#000
                    style BIGQUERY fill:#4285f4,color:#fff
                    style ANALYTICS fill:#34a853,color:#fff
            </div>
        </div>

        <h2>2. Data Processing Pipeline Flow</h2>
        <div class="description">
            Detailed view of the 13-step pipeline execution showing data flow from extraction through transformation to final delivery.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
                graph LR
                    subgraph "1. Configuration & Setup"
                        SETUP[0_Setup_Schema<br/>Catalog: r8_data_pipeline<br/>Schema Creation<br/>Table Initialization]
                        RESET[1_Reset_Data_Tagging<br/>Status Reset<br/>Collection Flags<br/>Fresh Cycle Prep]
                    end
                    
                    subgraph "2. Client Data Management"
                        GET_API[2_Get_Client_APIs<br/>Google Sheets Sync<br/>API Key Retrieval<br/>Client Configuration]
                        GET_LIST[3_Get_Client_Listings<br/>Property Inventory<br/>PMS Systems<br/>Collection Targets]
                        JOIN[4_Join_Table<br/>Client-Listing Merge<br/>API Key Association<br/>Master Dataset]
                    end
                    
                    subgraph "3. Data Extraction [5_1 - 9_1]"
                        EXT_PRICES[5_1 Extract Listing Prices<br/>365-day Forecasts<br/>Dynamic Pricing<br/>Rate Strategies]
                        EXT_NEIGH[6_1 Extract Neighborhood<br/>Market Analytics<br/>Comp Sets<br/>Percentile Data]
                        EXT_OVER[7_1 Extract Overrides<br/>Manual Adjustments<br/>Special Events<br/>Custom Pricing]
                        EXT_RATE[8_1 Extract Rate Plans<br/>Pricing Rules<br/>Seasonal Strategies<br/>Channel Rates]
                        EXT_RES[9_1 Extract Reservations<br/>Booking History<br/>Revenue Data<br/>Occupancy Patterns]
                    end
                    
                    subgraph "4. Bronze Transformation [5_2 - 9_2]"
                        BR_PRICES[5_2 Transform Prices<br/>Bronze Layer<br/>Schema Mapping<br/>Data Validation]
                        BR_NEIGH[6_2 Transform Neighborhood<br/>Bronze Layer<br/>Pivot Operations<br/>Percentile Processing]
                        BR_OCC[6_3 Transform Neighborhood Occ<br/>Bronze Layer<br/>Occupancy Metrics<br/>YoY Comparisons]
                        BR_OVER[7_2 Transform Overrides<br/>Bronze Layer<br/>Override Processing<br/>Date Parsing]
                        BR_RATE[8_2 Transform Rate Plans<br/>Bronze Layer<br/>JSON Normalization<br/>Metadata Addition]
                        BR_RES[9_2 Transform Reservations<br/>Bronze Layer<br/>Booking Processing<br/>Revenue Calculation]
                    end
                    
                    subgraph "5. Silver Refinement [6_4 - 9_3]"
                        SV_NEIGH[6_4 Transform Neighborhood<br/>Silver Layer<br/>Deduplication<br/>Quality Enhancement]
                        SV_OCC[6_5 Transform Neighborhood Occ<br/>Silver Layer<br/>Aggregations<br/>Metric Calculation]
                        SV_OVER[7_3 Transform Overrides<br/>Silver Layer<br/>Business Rules<br/>Validation Logic]
                        SV_RATE[8_3 Transform Rate Plans<br/>Silver Layer<br/>Plan Standardization<br/>Version Control]
                        SV_RES[9_3 Transform Reservations<br/>Silver Layer<br/>Revenue Analytics<br/>Guest Insights]
                    end
                    
                    subgraph "6. Gold Layer & Distribution"
                        GOLD_JOIN[10_Join_All_Data_Gold<br/>Master Dataset<br/>27 Columns<br/>Business Ready]
                        VALIDATE[11_Validate_Gold_Table<br/>Quality Checks<br/>Duplicate Detection<br/>Completeness Score]
                        UPDATE_STATUS[12_Update_GSheets<br/>Status Sync<br/>Collection Flags<br/>Quality Reports]
                        BIGQUERY[13_Load_to_BigQuery<br/>Cloud Export<br/>r8-pipeline-463804<br/>BI Integration]
                    end
                    
                    SETUP --> RESET
                    RESET --> GET_API
                    GET_API --> GET_LIST
                    GET_LIST --> JOIN
                    JOIN --> EXT_PRICES
                    EXT_PRICES --> BR_PRICES
                    JOIN --> EXT_NEIGH
                    EXT_NEIGH --> BR_NEIGH
                    BR_NEIGH --> BR_OCC
                    JOIN --> EXT_OVER
                    EXT_OVER --> BR_OVER
                    JOIN --> EXT_RATE
                    EXT_RATE --> BR_RATE
                    JOIN --> EXT_RES
                    EXT_RES --> BR_RES
                    BR_NEIGH --> SV_NEIGH
                    BR_OCC --> SV_OCC
                    BR_OVER --> SV_OVER
                    BR_RATE --> SV_RATE
                    BR_RES --> SV_RES
                    BR_PRICES --> GOLD_JOIN
                    SV_NEIGH --> GOLD_JOIN
                    SV_OCC --> GOLD_JOIN
                    SV_OVER --> GOLD_JOIN
                    SV_RATE --> GOLD_JOIN
                    SV_RES --> GOLD_JOIN
                    GOLD_JOIN --> VALIDATE
                    VALIDATE --> UPDATE_STATUS
                    VALIDATE --> BIGQUERY
                    
                    style GOLD_JOIN fill:#ffd700,color:#000
                    style BIGQUERY fill:#4285f4,color:#fff
            </div>
        </div>

        <h2>3. Medallion Architecture Data Model</h2>
        <div class="description">
            Database schema showing the relationships between Bronze, Silver, and Gold layers with key transformations at each level.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
                erDiagram
                    BRONZE_LISTING_PRICES {
                        string id PK
                        string pms
                        string date
                        string price
                        string min_stay
                        string booking_status
                        string ADR
                        string ADR_STLY
                        string booked_date
                        string booked_date_STLY
                        int min
                        string holiday_events
                    }
                    
                    BRONZE_NEIGHBORHOOD {
                        string Category
                        string Date
                        string customer
                        string listing_id FK
                        double _25th
                        double _50th
                        double _75th
                        double _90th
                        double Median_Booked_Price
                        double N_bookings
                        timestamp db_date
                    }
                    
                    BRONZE_NEIGHBORHOOD_OCC {
                        string listing_id FK
                        string client
                        string Category
                        string Date
                        double Occupancy
                        double New_Bookings
                        double Occupancy_LY
                        double Occupancy_STLY
                        double New_Bookings_STLY
                        timestamp db_date
                    }
                    
                    SILVER_OVERRIDES {
                        string id FK
                        string client
                        string date
                        string price
                        string price_type
                        double min_stay
                        string currency
                        timestamp db_date
                    }
                    
                    SILVER_RATE_PLANS {
                        string id FK
                        string client
                        string pms
                        string name
                        string rateplans
                        timestamp db_date
                    }
                    
                    SILVER_RESERVATIONS {
                        string listing_id FK
                        string client
                        string reservation_id PK
                        string check_in
                        string check_out
                        string booked_date
                        string total_cost
                        bigint no_of_days
                        timestamp db_date
                    }
                    
                    GOLD_FUTURE_PRICING_DATA {
                        string id PK
                        string Client
                        string Listing
                        string B
                        int MIN
                        string Date
                        string Month
                        string DOW
                        int Occ_Now
                        int STLY
                        int Occ_LYT
                        int Occ_Final
                        int Est_Occ_Left
                        int _25th
                        int _50th
                        int _75th
                        int _90th
                        string OLD
                        date OLD_Booked_Date
                        float NEW
                        date New_Booked_Date
                        int Number_of_days
                        float Price
                        string Holiday_Event
                        string Date_Over_Ride
                        int LOS
                    }
                    
                    BRONZE_LISTING_PRICES ||--o{ GOLD_FUTURE_PRICING_DATA : transforms_to
                    BRONZE_NEIGHBORHOOD ||--o{ GOLD_FUTURE_PRICING_DATA : enriches
                    BRONZE_NEIGHBORHOOD_OCC ||--o{ GOLD_FUTURE_PRICING_DATA : provides_occupancy
                    SILVER_OVERRIDES ||--o{ GOLD_FUTURE_PRICING_DATA : applies_overrides
                    SILVER_RATE_PLANS ||--o{ GOLD_FUTURE_PRICING_DATA : defines_rates
                    SILVER_RESERVATIONS ||--o{ GOLD_FUTURE_PRICING_DATA : historical_context
            </div>
        </div>

        <h2>4. API Integration & Data Extraction</h2>
        <div class="description">
            Detailed view of the PriceLabs API integration showing endpoints, data collection strategies, and storage patterns.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
                graph TB
                    subgraph "PriceLabs API Endpoints"
                        API_LISTINGS["API /v1/listings<br/>Property Inventory<br/>Configuration Data"]
                        API_PRICES["API /v1/listing_prices<br/>Dynamic Pricing<br/>365-day Forecasts<br/>Batch Processing"]
                        API_NEIGHBORHOOD["API /v1/neighborhood_data<br/>Market Analytics<br/>Percentile Pricing<br/>Competition Data"]
                        API_OVERRIDES["API /v1/listings/id/overrides<br/>Manual Adjustments<br/>Event Pricing<br/>Special Rules"]
                        API_RESERVATIONS["API /v1/reservation_data<br/>Booking History<br/>Revenue Analytics<br/>Guest Data"]
                        API_RATEPLANS["API /v1/fetch_rate_plans<br/>Pricing Strategies<br/>Channel Rules<br/>Seasonal Rates"]
                    end
                    
                    subgraph "ClientPriceLab Module"
                        HANDLER["API Handler<br/>Authentication<br/>Rate Limiting<br/>Retry Logic"]
                        FETCH["fetch_data()<br/>GET/POST Methods<br/>Error Handling<br/>Response Validation"]
                        SAVE["save_to_json()<br/>Date Partitioning<br/>Customer Segregation<br/>Listing Organization"]
                    end
                    
                    subgraph "Data Collection Methods"
                        BATCH["Batch Collection<br/>Listing Prices<br/>All Properties<br/>Single API Call"]
                        INDIVIDUAL["Individual Collection<br/>Neighborhood Data<br/>Overrides<br/>Rate Plans<br/>Per Listing Calls"]
                        AGGREGATE["Aggregate Collection<br/>Reservations<br/>By PMS and Date Range<br/>Paginated Results"]
                    end
                    
                    subgraph "Storage Structure"
                        JSON_STORE["JSON File Storage<br/>/FileStore/pricelab_data/<br/>listing_prices_data/<br/>neighborhood_data/<br/>overrides_data/<br/>rate_plans_data/<br/>reservations_data/<br/>YYYY/MM/DD/<br/>customer_listing.json"]
                    end
                    
                    API_LISTINGS --> HANDLER
                    API_PRICES --> HANDLER
                    API_NEIGHBORHOOD --> HANDLER
                    API_OVERRIDES --> HANDLER
                    API_RESERVATIONS --> HANDLER
                    API_RATEPLANS --> HANDLER
                    
                    HANDLER --> FETCH
                    FETCH --> BATCH
                    FETCH --> INDIVIDUAL
                    FETCH --> AGGREGATE
                    
                    BATCH --> SAVE
                    INDIVIDUAL --> SAVE
                    AGGREGATE --> SAVE
                    SAVE --> JSON_STORE
                    
                    style API_PRICES fill:#e8f5e8
                    style API_NEIGHBORHOOD fill:#e8f5e8
                    style HANDLER fill:#fff3e0
                    style JSON_STORE fill:#e3f2fd
            </div>
        </div>

        <h2>5. Data Transformation Logic</h2>
        <div class="description">
            Core transformation logic showing how raw API data is processed through Bronze and Silver layers to create the Gold table.
        </div>
        <div class="diagram-container">
            <div class="mermaid">
                graph TB
                    subgraph "Bronze Transformations"
                        BR_PRICE_LOGIC["Listing Prices<br/>Parse JSON responses<br/>Extract price arrays<br/>Flatten nested data<br/>Add MIN column<br/>Extract holiday_events"]
                        BR_NEIGH_LOGIC["Neighborhood Data<br/>Extract Future Percentiles<br/>Pivot category data<br/>Process X/Y values<br/>Map percentile labels<br/>Calculate metrics"]
                        BR_OCC_LOGIC["Neighborhood Occupancy<br/>Extract occupancy arrays<br/>Handle nested structures<br/>Process STLY metrics<br/>Calculate YoY changes<br/>Add temporal data"]
                    end
                    
                    subgraph "Silver Transformations"
                        SV_DEDUP["Deduplication Logic<br/>Remove duplicates by key<br/>Apply window functions<br/>Keep latest records<br/>Merge overlapping data<br/>Validate relationships"]
                        SV_ENRICH["Data Enrichment<br/>Standardize formats<br/>Add business logic<br/>Calculate derived fields<br/>Apply data types<br/>Handle nulls"]
                        SV_VALIDATE["Validation Rules<br/>Check constraints<br/>Verify relationships<br/>Test business rules<br/>Flag anomalies<br/>Score quality"]
                    end
                    
                    subgraph "Gold Layer Join Logic"
                        GOLD_LOGIC["Master Join Operation<br/>Base: clients_with_bedrooms<br/>Inner join: listing_prices<br/>Left join: rate_plans<br/>Left join: neighborhood<br/>Left join: neighborhood_occ<br/>Left join: overrides<br/>Calculate: STLY, Est_Occ_Left<br/>Add: DOW, LOS, Number_of_days<br/>Filter: 365-day forecast window<br/>Deduplicate: by id, Client, Date"]
                    end
                    
                    subgraph "Business Calculations"
                        CALC_STLY["STLY Calculation<br/>Occ_Now - Occ_LYT<br/>Year-over-year change"]
                        CALC_EST["Est_Occ_Left<br/>Occ_Final - Occ_LYT<br/>Remaining occupancy"]
                        CALC_DAYS["Number_of_days<br/>Date - New_Booked_Date<br/>Booking lead time"]
                        CALC_DOW["Day of Week<br/>date_format Date EEEE<br/>Weekday analysis"]
                    end
                    
                    BR_PRICE_LOGIC --> SV_DEDUP
                    BR_NEIGH_LOGIC --> SV_DEDUP
                    BR_OCC_LOGIC --> SV_DEDUP
                    SV_DEDUP --> SV_ENRICH
                    SV_ENRICH --> SV_VALIDATE
                    SV_VALIDATE --> GOLD_LOGIC
                    GOLD_LOGIC --> CALC_STLY
                    GOLD_LOGIC --> CALC_EST
                    GOLD_LOGIC --> CALC_DAYS
                    GOLD_LOGIC --> CALC_DOW
                    
                    style GOLD_LOGIC fill:#ffd700,color:#000
                    style SV_VALIDATE fill:#c0c0c0,color:#000
            </div>
        </div>

        <h2>6. Technology Stack</h2>
        <div class="tech-stack">
            <div class="tech-card">
                <h4>üèóÔ∏è Infrastructure</h4>
                <ul>
                    <li>Databricks Platform</li>
                    <li>Delta Lake Storage</li>
                    <li>Apache Spark Processing</li>
                    <li>Google Cloud BigQuery</li>
                    <li>Scheduled Workflows</li>
                </ul>
            </div>
            <div class="tech-card">
                <h4>üìä Data Sources</h4>
                <ul>
                    <li>PriceLabs REST API</li>
                    <li>Google Sheets Integration</li>
                    <li>JSON File Storage</li>
                    <li>Service Account Auth</li>
                    <li>OAuth2 Credentials</li>
                </ul>
            </div>
            <div class="tech-card">
                <h4>üîß Processing Layers</h4>
                <ul>
                    <li>Bronze: Raw ingestion</li>
                    <li>Silver: Cleansing & dedup</li>
                    <li>Gold: Business ready</li>
                    <li>Validation: Quality checks</li>
                    <li>Export: Cloud distribution</li>
                </ul>
            </div>
            <div class="tech-card">
                <h4>üêç Python Modules</h4>
                <ul>
                    <li>PySpark DataFrames</li>
                    <li>Pandas Processing</li>
                    <li>Requests (API calls)</li>
                    <li>gspread (Google Sheets)</li>
                    <li>google-cloud-bigquery</li>
                </ul>
            </div>
            <div class="tech-card">
                <h4>üìà Data Volumes</h4>
                <ul>
                    <li>Multiple clients</li>
                    <li>365-day forecasts</li>
                    <li>Daily price updates</li>
                    <li>Neighborhood analytics</li>
                    <li>Historical reservations</li>
                </ul>
            </div>
            <div class="tech-card">
                <h4>‚úÖ Quality Framework</h4>
                <ul>
                    <li>Duplicate detection</li>
                    <li>Completeness scoring</li>
                    <li>Schema validation</li>
                    <li>Null handling</li>
                    <li>Type casting</li>
                </ul>
            </div>
        </div>

        <h2>7. Gold Table Schema - Business Ready Dataset</h2>
        <div class="description">
            Complete schema for the Gold layer table with all 27 columns used for pricing optimization and revenue management.
        </div>
        <table class="metrics-table">
            <thead>
                <tr>
                    <th>Column Name</th>
                    <th>Data Type</th>
                    <th>Description</th>
                    <th>Source</th>
                    <th>Business Use</th>
                </tr>
            </thead>
            <tbody>
                <tr><td><strong>id</strong></td><td>string</td><td>Unique listing identifier</td><td>Primary Key</td><td>Property tracking</td></tr>
                <tr><td><strong>Client</strong></td><td>string</td><td>Property owner/manager</td><td>Client data</td><td>Portfolio management</td></tr>
                <tr><td><strong>Listing</strong></td><td>string</td><td>Property name</td><td>Rate plans</td><td>Property identification</td></tr>
                <tr><td><strong>B</strong></td><td>string</td><td>Bedroom count</td><td>Client data</td><td>Segmentation</td></tr>
                <tr><td><strong>MIN</strong></td><td>int</td><td>Minimum price</td><td>Listing prices</td><td>Price floor</td></tr>
                <tr><td><strong>Date</strong></td><td>string</td><td>Forecast date</td><td>Time dimension</td><td>Timeline analysis</td></tr>
                <tr><td><strong>Month</strong></td><td>string</td><td>Month name</td><td>Derived</td><td>Seasonal analysis</td></tr>
                <tr><td><strong>DOW</strong></td><td>string</td><td>Day of week</td><td>Derived</td><td>Weekday patterns</td></tr>
                <tr><td><strong>Occ_Now</strong></td><td>int</td><td>Current occupancy %</td><td>Neighborhood</td><td>Market status</td></tr>
                <tr><td><strong>STLY</strong></td><td>int</td><td>Same time last year diff</td><td>Calculated</td><td>YoY comparison</td></tr>
                <tr><td><strong>Occ_LYT</strong></td><td>int</td><td>Last year occupancy</td><td>Neighborhood</td><td>Historical baseline</td></tr>
                <tr><td><strong>Occ_Final</strong></td><td>int</td><td>Final occupancy</td><td>Neighborhood</td><td>Performance metric</td></tr>
                <tr><td><strong>Est_Occ_Left</strong></td><td>int</td><td>Estimated remaining</td><td>Calculated</td><td>Opportunity analysis</td></tr>
                <tr><td><strong>_25th</strong></td><td>int</td><td>25th percentile price</td><td>Neighborhood</td><td>Market positioning</td></tr>
                <tr><td><strong>_50th</strong></td><td>int</td><td>Median price</td><td>Neighborhood</td><td>Market benchmark</td></tr>
                <tr><td><strong>_75th</strong></td><td>int</td><td>75th percentile price</td><td>Neighborhood</td><td>Premium positioning</td></tr>
                <tr><td><strong>_90th</strong></td><td>int</td><td>90th percentile price</td><td>Neighborhood</td><td>Luxury benchmark</td></tr>
                <tr><td><strong>OLD</strong></td><td>string</td><td>Previous year ADR</td><td>Listing prices</td><td>Historical rate</td></tr>
                <tr><td><strong>OLD_Booked_Date</strong></td><td>date</td><td>Last year booking date</td><td>Listing prices</td><td>Booking patterns</td></tr>
                <tr><td><strong>NEW</strong></td><td>float</td><td>Current ADR</td><td>Listing prices</td><td>Active rate</td></tr>
                <tr><td><strong>New_Booked_Date</strong></td><td>date</td><td>Current booking date</td><td>Listing prices</td><td>Lead time analysis</td></tr>
                <tr><td><strong>Number_of_days</strong></td><td>int</td><td>Days until arrival</td><td>Calculated</td><td>Booking window</td></tr>
                <tr><td><strong>Price</strong></td><td>float</td><td>Listed price</td><td>Listing prices</td><td>Revenue calculation</td></tr>
                <tr><td><strong>Holiday_Event</strong></td><td>string</td><td>Special event flag</td><td>Listing prices</td><td>Event pricing</td></tr>
                <tr><td><strong>Date_Over_Ride</strong></td><td>string</td><td>Manual override</td><td>Overrides</td><td>Custom pricing</td></tr>
                <tr><td><strong>LOS</strong></td><td>int</td><td>Length of stay</td><td>Listing prices</td><td>Stay requirements</td></tr>
            </tbody>
        </table>

        <h2>8. Business Value & Analytics Capabilities</h2>
        <div class="pipeline-stage">
            <h4>üí∞ Dynamic Pricing Optimization</h4>
            <p><strong>365-Day Forecasting:</strong> Complete year-ahead pricing recommendations with daily granularity, incorporating market dynamics, seasonal patterns, and competitive positioning.</p>
            <p><strong>Percentile Analysis:</strong> Multi-tier pricing strategy using 25th, 50th, 75th, and 90th percentile market comparisons for optimal rate positioning.</p>
        </div>

        <div class="pipeline-stage">
            <h4>üìä Market Intelligence</h4>
            <p><strong>Neighborhood Analytics:</strong> Competitive set analysis with market occupancy trends and pricing distributions across comparable properties.</p>
            <p><strong>YoY Comparisons:</strong> Historical performance tracking with STLY (Same Time Last Year) metrics for trend identification and forecasting accuracy.</p>
        </div>

        <div class="pipeline-stage">
            <h4>üéØ Revenue Management</h4>
            <p><strong>Occupancy Forecasting:</strong> Advanced occupancy predictions with Est_Occ_Left calculations showing remaining inventory opportunities.</p>
            <p><strong>Event-Based Pricing:</strong> Holiday and special event detection with automatic pricing adjustments and override capabilities.</p>
        </div>

        <div class="pipeline-stage">
            <h4>üîÑ Operational Excellence</h4>
            <p><strong>Automated Batch Pipeline:</strong> End-to-end batch automation from scheduled API extraction through BigQuery deployment with quality validation at each stage.</p>
            <p><strong>Configuration Management:</strong> Google Sheets integration for batch configuration updates and status monitoring without code deployment.</p>
        </div>

        <div class="highlight">
            <h3>üéØ Platform Summary</h3>
            <p><strong>Technical Achievement:</strong> Production-grade batch processing pipeline implementing medallion architecture with automated API integration, multi-stage batch transformations, and cloud-based analytics delivery.</p>
            <p><strong>Business Impact:</strong> Enables data-driven revenue optimization for vacation rental portfolios through daily batch processing of market-based pricing, occupancy forecasting, and competitive intelligence across multiple property management systems.</p>
            <p><strong>Scale & Performance:</strong> Processes multiple clients with hundreds of properties in scheduled batches, generating 365-day forecasts with neighborhood analytics and historical context for strategic pricing decisions.</p>
        </div>

        <footer>
            <p>R8 Future Pricing Pipeline | Data Architecture with Databricks</p>
            <p>Production Pipeline for Vacation Rental Revenue Optimization</p>
            <p><em>Medallion Architecture & Cloud Analytics Integration</em></p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            er: {
                useMaxWidth: true
            }
        });
    </script>
</body>
</html>